<hr/>
<h2 id="i2c">I2C</h2>
<p>The example uses the I2C API to communicate with a <span class="badge badge-info">MCP9808</span> sensor and print every 1 second the measured temperature.</p>

<pre class="ecmascript-code">

var mcp9808 = {
  slave_address: 0x18,
  methods: {
    request_id: 0x06,
    request_temperature: 0x05
  },
  send_buffer: Uint8Array.allocPlain(1),
  receive_buffer: Uint8Array.allocPlain(2),
  frequency: 150
};

mcp9808.send_buffer[0] = mcp9808.methods.request_temperature; 

var tick;
var interval = 1000;

const sensor = i2c(I2C1); 
sensor.frequency(mcp9808.frequency); 

sensor.on('open', function () { 
  tick = setInterval(function () { 
    sensor.transfer(mcp9808.slave_address, mcp9808.send_buffer, mcp9808.receive_buffer); 
  }, interval); 

  sensor.on('data', function(data) { 
    mcp9808.receive_buffer = data;
    data[0] = data[0] & 0x1F;
    var signed = data[0] & (1 << 5) ? -1 : 1;
    var temperature = signed * (data[0] * Math.pow(2, 4) + data[1] * Math.pow(2, -4));
    var symbol = signed ? '+' : '-';
    var message = [
      'Raw data received',
      'MSB:' + data[0],
      'LSB:' + data[1],
      'Signed:',
      signed,
      'Temperature:',
      symbol,
      temperature,
      'C'
    ].join(' ');

    print(message); 
  }); 
}); 

</pre>

