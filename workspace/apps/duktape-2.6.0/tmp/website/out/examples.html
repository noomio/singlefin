<!DOCTYPE html>
<html class="h-100">
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-142558169-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-142558169-2');
</script>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<meta content="" name="description"/>
<!-- combined stylesheet -->
<link href="style.css" rel="stylesheet" type="text/css"/>
<title>Javascript Examples</title>
</head>
<body class="d-flex flex-column h-100">
<main class="flex-shrink-0" role="main">
<div id="site-top">
<div id="site-top-logo">
<strong id="logo"> NoomioJS</strong>
</div> <!-- site-top-logo -->
<div id="site-top-nav">
<ul>
<li><a href="index.html">Home</a></li>
<li><a href="guide.html">Guide</a></li>
<li class="selected"><a href="examples.html">Examples</a></li>
<li><a href="download.html">Download</a></li>
<li><a href="api.html">API</a></li>
<li><a href="dfota.html">Dfota</a></li>
</ul>
</div> <!-- site-top-nav -->
</div> <!-- site-top -->
<div id="site-middle">
<div id="site-middle-nav"><ul>
<li><a href="#hello-world">Hello World</a></li>
<li><a href="#timer">Timer</a></li>
<li><a href="#i2c">I2C</a></li>
</ul></div> <!-- site-middle-nav -->
<div class="container content" id="site-middle-content"><h1 class="sectiontitle" id="doc.1">Javascript Examples <a class="sectionlink" href="#doc.1">§</a></h1><p>Create a file name <span class="badge badge-dark">app.js</span> and place it in working directory or use the Interactive Console to send the file directly (See <a href="index.html">API</a>).</p><h2 class="sectiontitle" id="hello-world">Hello World <a class="sectionlink" href="#hello-world">§</a></h2><p>Let's start with outputing text to stdout with the <span class="badge badge-info">print</span> function.</p><table class="table">
<thead>
<tr>
<th scope="col">Port Name</th>
<th scope="col">Baud Rate</th>
</tr>
</thead>
<tbody>
<tr>
<td>COM (DEBUG)</td>
<td>115200</td>
</tr>
</tbody>
</table><h3 class="sectiontitle" id="hello-world.1">Hardware Setup <a class="sectionlink" href="#hello-world.1">§</a></h3><figure class="figure">
<img alt="..." class="figure-img img-fluid rounded" src="example-print.png" style="max-width: 70%"/>
<figcaption class="figure-caption">BG96 EVB Kit v1.1 connected to PC</figcaption>
</figure><h3 class="sectiontitle" id="hello-world.2">Javascript Code <a class="sectionlink" href="#hello-world.2">§</a></h3><pre class="ecmascript-code">
<span class="function">print</span><span class="symbol">(</span><span class="string">'Hello from Javascript!'</span><span class="symbol">)</span><span class="symbol">;</span>
</pre><hr/><h2 class="sectiontitle" id="timer">Timer <a class="sectionlink" href="#timer">§</a></h2><p>The example below uses the <span class="badge badge-info">DigitalOut</span>, <span class="badge badge-info">Timer</span> and <span class="badge badge-info">print</span> API. The function <span class="badge badge-info">print</span> is used to output information over the serial.</p><h3 class="sectiontitle" id="timer.1">Hardware Setup <a class="sectionlink" href="#timer.1">§</a></h3><figure class="figure">
<img alt="..." class="figure-img img-fluid rounded" src="example-digout.png" style="max-width: 70%"/>
<figcaption class="figure-caption">BG96 EVB Kit v1.1 Digital Output with Led</figcaption>
</figure><h3 class="sectiontitle" id="timer.2">Javascript Code <a class="sectionlink" href="#timer.2">§</a></h3><pre class="ecmascript-code">
<span class="keyword">var</span><span class="normal"> count </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span>
<span class="keyword">var</span><span class="normal"> intervalId</span><span class="symbol">;</span>

<span class="normal">dout </span><span class="symbol">=</span><span class="normal"> </span><span class="function">DigitalOut</span><span class="symbol">(</span><span class="normal">PIN4</span><span class="symbol">)</span><span class="symbol">;</span><span class="normal"> </span>
<span class="keyword">var</span><span class="normal"> val </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>

<span class="function">setTimeout</span><span class="symbol">(</span><span class="keyword">function</span><span class="normal"> </span><span class="function">cb</span><span class="symbol">(</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">   </span><span class="function">print</span><span class="symbol">(</span><span class="string">'one shot timer, called after 10 seconds'</span><span class="symbol">)</span><span class="symbol">;</span>
<span class="cbracket">}</span><span class="symbol">,</span><span class="normal"> </span><span class="number">10000</span><span class="symbol">)</span><span class="symbol">;</span>


<span class="normal">intervalId </span><span class="symbol">=</span><span class="normal"> </span><span class="function">setInterval</span><span class="symbol">(</span><span class="keyword">function</span><span class="normal"> </span><span class="symbol">(</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>

<span class="normal">    </span><span class="function">print</span><span class="symbol">(</span><span class="string">'interval'</span><span class="symbol">,</span><span class="normal"> </span><span class="symbol">+</span><span class="symbol">+</span><span class="normal">count</span><span class="symbol">)</span><span class="symbol">;</span>
<span class="normal">    </span>
<span class="normal">    val </span><span class="symbol">=</span><span class="normal"> </span><span class="symbol">!</span><span class="normal">val</span><span class="symbol">;</span>
<span class="normal">    dout</span><span class="symbol">.</span><span class="function">write</span><span class="symbol">(</span><span class="normal">val</span><span class="symbol">)</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">count </span><span class="symbol">&gt;</span><span class="symbol">=</span><span class="normal"> </span><span class="number">25</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">      </span><span class="function">clearInterval</span><span class="symbol">(</span><span class="normal">intervalId</span><span class="symbol">)</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="cbracket">}</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1000</span><span class="symbol">)</span><span class="symbol">;</span>

<span class="function">print</span><span class="symbol">(</span><span class="string">"Hello from Javascript!"</span><span class="symbol">)</span><span class="symbol">;</span>

</pre><p>Note that execution order is: 
</p><div class="alert alert-primary w-25" role="alert">Hello from Javascript!</div><img alt="" height="32" src="assets/arrow-down.svg" width="32"/><div class="alert alert-primary w-25" role="alert">interval1</div><img alt="" height="32" src="assets/arrow-down.svg" width="32"/><div class="alert alert-primary w-25" role="alert">interval2</div><img alt="" height="32" src="assets/arrow-down.svg" width="32"/><div class="alert alert-primary w-25" role="alert">...</div><img alt="" height="32" src="assets/arrow-down.svg" width="32"/><div class="alert alert-primary w-25" role="alert">interval10</div><img alt="" height="32" src="assets/arrow-down.svg" width="32"/><div class="alert alert-primary w-25" role="alert">one shot timer, called after 10 seconds</div><img alt="" height="32" src="assets/arrow-down.svg" width="32"/><div class="alert alert-primary w-25" role="alert">interval11</div><img alt="" height="32" src="assets/arrow-down.svg" width="32"/><div class="alert alert-primary w-25" role="alert">...</div><img alt="" height="32" src="assets/arrow-down.svg" width="32"/><div class="alert alert-primary w-25" role="alert">interval25</div><hr/><h2 class="sectiontitle" id="i2c">I2C <a class="sectionlink" href="#i2c">§</a></h2><p>The example uses the I2C API to communicate with a <span class="badge badge-info">MCP9808</span> sensor and print every 1 second the measured temperature.</p><pre class="ecmascript-code">

<span class="keyword">var</span><span class="normal"> mcp9808 </span><span class="symbol">=</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">  slave_address</span><span class="symbol">:</span><span class="normal"> </span><span class="number">0x18</span><span class="symbol">,</span>
<span class="normal">  methods</span><span class="symbol">:</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">    request_id</span><span class="symbol">:</span><span class="normal"> </span><span class="number">0x06</span><span class="symbol">,</span>
<span class="normal">    request_temperature</span><span class="symbol">:</span><span class="normal"> </span><span class="number">0x05</span>
<span class="normal">  </span><span class="cbracket">}</span><span class="symbol">,</span>
<span class="normal">  send_buffer</span><span class="symbol">:</span><span class="normal"> Uint8Array</span><span class="symbol">.</span><span class="function">allocPlain</span><span class="symbol">(</span><span class="number">1</span><span class="symbol">)</span><span class="symbol">,</span>
<span class="normal">  receive_buffer</span><span class="symbol">:</span><span class="normal"> Uint8Array</span><span class="symbol">.</span><span class="function">allocPlain</span><span class="symbol">(</span><span class="number">2</span><span class="symbol">)</span><span class="symbol">,</span>
<span class="normal">  frequency</span><span class="symbol">:</span><span class="normal"> </span><span class="number">150</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="normal">mcp9808</span><span class="symbol">.</span><span class="normal">send_buffer</span><span class="symbol">[</span><span class="number">0</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">=</span><span class="normal"> mcp9808</span><span class="symbol">.</span><span class="normal">methods</span><span class="symbol">.</span><span class="normal">request_temperature</span><span class="symbol">;</span><span class="normal"> </span>

<span class="keyword">var</span><span class="normal"> tick</span><span class="symbol">;</span>
<span class="keyword">var</span><span class="normal"> interval </span><span class="symbol">=</span><span class="normal"> </span><span class="number">1000</span><span class="symbol">;</span>

<span class="keyword">const</span><span class="normal"> sensor </span><span class="symbol">=</span><span class="normal"> </span><span class="function">i2c</span><span class="symbol">(</span><span class="normal">I2C1</span><span class="symbol">)</span><span class="symbol">;</span><span class="normal"> </span>
<span class="normal">sensor</span><span class="symbol">.</span><span class="function">frequency</span><span class="symbol">(</span><span class="normal">mcp9808</span><span class="symbol">.</span><span class="normal">frequency</span><span class="symbol">)</span><span class="symbol">;</span><span class="normal"> </span>

<span class="normal">sensor</span><span class="symbol">.</span><span class="function">on</span><span class="symbol">(</span><span class="string">'open'</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">function</span><span class="normal"> </span><span class="symbol">(</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span><span class="normal"> </span>
<span class="normal">  tick </span><span class="symbol">=</span><span class="normal"> </span><span class="function">setInterval</span><span class="symbol">(</span><span class="keyword">function</span><span class="normal"> </span><span class="symbol">(</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span><span class="normal"> </span>
<span class="normal">    sensor</span><span class="symbol">.</span><span class="function">transfer</span><span class="symbol">(</span><span class="normal">mcp9808</span><span class="symbol">.</span><span class="normal">slave_address</span><span class="symbol">,</span><span class="normal"> mcp9808</span><span class="symbol">.</span><span class="normal">send_buffer</span><span class="symbol">,</span><span class="normal"> mcp9808</span><span class="symbol">.</span><span class="normal">receive_buffer</span><span class="symbol">)</span><span class="symbol">;</span><span class="normal"> </span>
<span class="normal">  </span><span class="cbracket">}</span><span class="symbol">,</span><span class="normal"> interval</span><span class="symbol">)</span><span class="symbol">;</span><span class="normal"> </span>

<span class="normal">  sensor</span><span class="symbol">.</span><span class="function">on</span><span class="symbol">(</span><span class="string">'data'</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">function</span><span class="symbol">(</span><span class="normal">data</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span><span class="normal"> </span>
<span class="normal">    mcp9808</span><span class="symbol">.</span><span class="normal">receive_buffer </span><span class="symbol">=</span><span class="normal"> data</span><span class="symbol">;</span>
<span class="normal">    data</span><span class="symbol">[</span><span class="number">0</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">=</span><span class="normal"> data</span><span class="symbol">[</span><span class="number">0</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&amp;</span><span class="normal"> </span><span class="number">0x1F</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">var</span><span class="normal"> signed </span><span class="symbol">=</span><span class="normal"> data</span><span class="symbol">[</span><span class="number">0</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&amp;</span><span class="normal"> </span><span class="symbol">(</span><span class="number">1</span><span class="normal"> </span><span class="symbol">&lt;</span><span class="symbol">&lt;</span><span class="normal"> </span><span class="number">5</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">?</span><span class="normal"> </span><span class="symbol">-</span><span class="number">1</span><span class="normal"> </span><span class="symbol">:</span><span class="normal"> </span><span class="number">1</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">var</span><span class="normal"> temperature </span><span class="symbol">=</span><span class="normal"> signed </span><span class="symbol">*</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">data</span><span class="symbol">[</span><span class="number">0</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">*</span><span class="normal"> Math</span><span class="symbol">.</span><span class="function">pow</span><span class="symbol">(</span><span class="number">2</span><span class="symbol">,</span><span class="normal"> </span><span class="number">4</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">+</span><span class="normal"> data</span><span class="symbol">[</span><span class="number">1</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">*</span><span class="normal"> Math</span><span class="symbol">.</span><span class="function">pow</span><span class="symbol">(</span><span class="number">2</span><span class="symbol">,</span><span class="normal"> </span><span class="symbol">-</span><span class="number">4</span><span class="symbol">)</span><span class="symbol">)</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">var</span><span class="normal"> symbol </span><span class="symbol">=</span><span class="normal"> signed </span><span class="symbol">?</span><span class="normal"> </span><span class="string">'+'</span><span class="normal"> </span><span class="symbol">:</span><span class="normal"> </span><span class="string">'-'</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">var</span><span class="normal"> message </span><span class="symbol">=</span><span class="normal"> </span><span class="symbol">[</span>
<span class="normal">      </span><span class="string">'Raw data received'</span><span class="symbol">,</span>
<span class="normal">      </span><span class="string">'MSB:'</span><span class="normal"> </span><span class="symbol">+</span><span class="normal"> data</span><span class="symbol">[</span><span class="number">0</span><span class="symbol">]</span><span class="symbol">,</span>
<span class="normal">      </span><span class="string">'LSB:'</span><span class="normal"> </span><span class="symbol">+</span><span class="normal"> data</span><span class="symbol">[</span><span class="number">1</span><span class="symbol">]</span><span class="symbol">,</span>
<span class="normal">      </span><span class="string">'Signed:'</span><span class="symbol">,</span>
<span class="normal">      signed</span><span class="symbol">,</span>
<span class="normal">      </span><span class="string">'Temperature:'</span><span class="symbol">,</span>
<span class="normal">      symbol</span><span class="symbol">,</span>
<span class="normal">      temperature</span><span class="symbol">,</span>
<span class="normal">      </span><span class="string">'C'</span>
<span class="normal">    </span><span class="symbol">]</span><span class="symbol">.</span><span class="function">join</span><span class="symbol">(</span><span class="string">' '</span><span class="symbol">)</span><span class="symbol">;</span>

<span class="normal">    </span><span class="function">print</span><span class="symbol">(</span><span class="normal">message</span><span class="symbol">)</span><span class="symbol">;</span><span class="normal"> </span>
<span class="normal">  </span><span class="cbracket">}</span><span class="symbol">)</span><span class="symbol">;</span><span class="normal"> </span>
<span class="cbracket">}</span><span class="symbol">)</span><span class="symbol">;</span><span class="normal"> </span>

</pre></div> <!-- site-middle-content -->
</div> <!-- site-middle -->
</main>
<footer class="footer mt-auto py-3" style="background-color: #f5f5f5;">
<div class="container">
<span class="text-muted">NoomioJS</span>
</div>
</footer>
</body>
</html>
